<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: controller_instrumentation.rb</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../../../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>controller_instrumentation.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>vendor/plugins/newrelic_rpm/lib/new_relic/agent/instrumentation/controller_instrumentation.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Thu Sep 03 18:46:32 -0400 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="../../../../../../../../classes/NewRelic.html">NewRelic</a>
instrumentation for controllers
</p>
<p>
This instrumentation is applied to the action controller by default if the
agent is actively collecting statistics. It will collect statistics for the
given action.
</p>
<p>
In cases where you don&#8216;t want to instrument the top level action, but
instead have other methods which are dispatched to by your action, and you
want to treat these as distinct actions, then what you need to do is call
newrelic_ignore on the top level action, and manually instrument the called
&#8216;actions&#8217;.
</p>
<p>
Here&#8216;s an example of a controller with a send_message action which
dispatches to more specific send_servicename methods. This results in the
controller action stats showing up for send_servicename.
</p>
<p>
MyController &lt; ActionController::Base
</p>
<pre>
  newrelic_ignore :only =&gt; 'send_message'
  # dispatch this action to the method given by the service parameter.
  def send_message
    service = params['service']
    dispatch_to_method = &quot;send_messge_to_#{service}&quot;
    perform_action_with_newrelic_trace(dispatch_to_method) do
      send dispatch_to_method, params['message']
    end
  end
</pre>
<p>
end
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>